<div class="container m-4" data-controller="search-users">
  <h1>New form</h1>
  <div class="d-flex">
    <img src="<%=asset_path('logo.png')%>" style="height: 50px;" alt="">
    <form action="/meetings/new" method="get" data-search-users-target="form">
      <input
        type="text"
        name="query"
        data-search-users-target="input"
        data-action="keyup->search-users#search"
        value="<%= params[:query] %>"
        placeholder="Type the members..."
        style="width: 400px; background: lavender; border: none"
      />
    </form>
  </div>
  <div id="form-container" data-controller="form-steps">
    <%= simple_form_for @meeting, data: { controller: 'flatpickr' } do |f| %>
      <div data-form-steps-target="step" class="input-button" style="margin-left: 64px;">
        <div data-search-users-target="users">
          <% if @users_filtered.present? && @users_filtered.length.positive? %>
            <%= render 'list' %>
          <% else %>
            <p>No users found.</p>
          <% end %>
        </div>
        <div data-search-users-target="usersClicked" class="hidden"></div>
        <button type="button" data-action="click->form-steps#nextStep" class="button-general ms-3" role="button">Next</button>
      </div>
      <div data-form-steps-target="step" class="hidden">
        <div class="d-flex" style="margin-top: 20px;">
          <img src="<%=asset_path('logo.png')%>" style="height: 50px;" alt="">
          <%= f.input :description, label: false, placeholder: "Type description", input_html:{style: "width: 400px; background: lavender; margin-right: 24px;", data: {form_steps_target: "description"}} %>
          <button type="button" data-action="click->form-steps#nextStep" class="button-general" role="button">Next</button>
        </div>
      </div>
      <div data-form-steps-target="step" class="hidden mb-3">
        <!--<p> <%= @users_names %></p> -->
        <p style="margin-right: 185px; margin-left: 66px; font-size: revert;">The next available time is....</p>
        <%= f.input :start_date, as: :string, input_html: { data: { flatpickr_target: "startTime", form_steps_target: "startTime" } } %>
        <%= f.input :end_date, as: :string, input_html: { data: { flatpickr_target: "endTime" }, id: 'end_time' } %>
        <button type="button" data-action="click->form-steps#nextStep" class="button-general" role="button">Next</button>
      </div>
      <div data-form-steps-target="step" class="hidden mb-3">
        <%= f.input :duration ,input_html:{data: {form_steps_target: "duration"}} %>
        <button type="button" data-action="click->form-steps#nextStep" class="button-general" role="button">Next</button>
      </div>
      <div data-form-steps-target="step" class="hidden">
        <%= f.input :location, input_html:{data: {form_steps_target: "location"}} %>
        <div data-form-steps-target="gptResult">
          <%= render "objectives_and_agenda", result: @result %>
        </div>
        <button type="button" data-action="click->form-steps#fetchResultsFromForm" class="button-general" role="button">Generate</button>
        <%= f.submit class:"button-general", role:"button"%>
      </div>
      <div data-form-steps-target="step" class="hidden">
      </div>

    <% end %>
  </div>
</div>
