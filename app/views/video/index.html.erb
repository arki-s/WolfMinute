<%= render partial: 'modal' %>
<p> <%= @transcript %> </p>
<script src="https://static.opentok.com/v1/js/video-express.js"></script>
<header>
  <%= render partial: 'header' %>
</header>
<main class="app">
  <div id="roomContainer"></div>
  <toolbar>
    <%#= render partial: 'toolbar' %>
  </toolbar>
</main>
<script>
  const room = new VideoExpress.Room({
   apiKey: '<%= @api_key %>', // add your OpenTok API key
   sessionId: '<%= @session_id %>', // add your OpenTok Session ID
   token: '<%= @token %>', // add your OpenTok token
   roomContainer: 'roomContainer',
   participantName: '<%= @name %>'
  });
  room.join();
</script>
<%= render "video/timebar" %>
<div class="row" data-controller="recording">
  <button data-action="click->recording#record" class="my-2 fas fa-microphone-alt big-icon audio-button" data-recording-target="start_recording" type="button"></button>
  <button data-action="click->recording#stop_recording" class="my-2 fas fa-assistive-listening-systems d-none big-icon audio-button" data-recording-target="ear" type="button"></button>
  <button data-action="click->recording#record" class="my-2 far fa-check-circle d-none big-icon audio-button text-white" data-recording-target="start_playback" type="button"></button>
  <div class="col">
    <article class="clip my-2 d-flex justify-content-center d-none"
              data-recording-target="clip">
      <audio controls src=""></audio>
    </article>
    <div class="d-grid gap-2">
      <button class="btn btn-danger stop d-none"
                data-action="click->recording#stop_recording"
        data-recording-target="stop_recording" type="button">Stop Recording</button>
      <button class="btn btn-danger d-none" type="button"
                  data-recording-target="stop_playback">Stop Playback</button>
      <button class="btn btn-purple d-none" type="button"
                  data-action="click->recording#reset"
        data-recording-target="reset_playback">Reset</button>
      <%# <%= f.input :file, as: :file, class: "d-none" %>
      <%= simple_form_for @video,html: {data: { recording_target: "form" }} do |f| %>
        <%= f.input :audio, as: :hidden %>
        <%= f.submit "Upload", class: "btn btn-primary d-none", data: { recording_target: 'upload', action: "click->recording#upload" } %>
      <% end %>
    </div>
  </div>
</div>
